{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}GiftTree - Send Flowers, Cakes & Gifts Online{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- GiftTree CSS Files -->
    <link href="{% static 'css/base.css' %}" rel="stylesheet">
    <link href="{% static 'css/mobile.css' %}" rel="stylesheet">
    <link href="{% static 'css/components.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">

    <!-- Meta Tags -->
    <meta name="description" content="{% block meta_description %}Send beautiful flowers, delicious cakes and amazing gifts online. Same day delivery available across India.{% endblock %}">
    <meta name="keywords" content="flowers, cakes, gifts, online delivery, same day delivery">
    <meta name="author" content="GiftTree">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}GiftTree - Send Flowers, Cakes & Gifts Online{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Send beautiful flowers, delicious cakes and amazing gifts online. Same day delivery available across India.{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:image" content="{% block og_image %}{% static 'images/logo.png' %}{% endblock %}">

    <style>
        /* Page-specific overrides and customizations */
        body {
            padding-bottom: 80px; /* Space for mobile bottom nav */
        }

        @media (min-width: 992px) {
            body {
                padding-bottom: 0;
            }
        }
    </style>

    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- Desktop Header -->
    {% include 'includes/desktop_header.html' %}

    <!-- Mobile Header -->
    {% include 'includes/mobile_header.html' with show_search_bar=True show_location_bar=True %}

    <!-- Mobile Navigation -->
    {% include 'includes/mobile_navigation.html' %}

    <!-- Messages -->
    {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Main Content -->
    <main style="padding-bottom: 80px;">
        {% block content %}{% endblock %}
    </main>

    <!-- Bottom navigation is included in mobile_navigation.html -->

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- GiftTree JavaScript Files -->
    <script src="{% static 'js/main.js' %}"></script>

    <!-- Enhanced UI JavaScript -->
    <script>
        // Cart functionality
        function addToCart() {
            showToast('Item added to cart!');

            // Haptic feedback for mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        // Toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            if (toast) {
                toast.textContent = message;
                toast.classList.add('show');

                setTimeout(() => {
                    toast.classList.remove('show');
                }, 2000);
            }
        }

        // Initialize enhanced UI features
        document.addEventListener('DOMContentLoaded', function() {
            // Add smooth scrolling for mobile products
            const productScrolls = document.querySelectorAll('.products-scroll');
            productScrolls.forEach(scroll => {
                let isDown = false;
                let startX;
                let scrollLeft;

                scroll.addEventListener('mousedown', (e) => {
                    isDown = true;
                    startX = e.pageX - scroll.offsetLeft;
                    scrollLeft = scroll.scrollLeft;
                });

                scroll.addEventListener('mouseleave', () => {
                    isDown = false;
                });

                scroll.addEventListener('mouseup', () => {
                    isDown = false;
                });

                scroll.addEventListener('mousemove', (e) => {
                    if (!isDown) return;
                    e.preventDefault();
                    const x = e.pageX - scroll.offsetLeft;
                    const walk = (x - startX) * 2;
                    scroll.scrollLeft = scrollLeft - walk;
                });
            });
        });
    </script>
    
    <!-- Page-specific JavaScript -->
    {% block page_js %}{% endblock %}

    {% block extra_js %}{% endblock %}
</body>
</html>